# --- 变量定义 (Variables) ---
set $mod Mod4
set $term kitty
#set $menu wofi --show drun --allow-images
set $menu fuzzel

# --- 视觉风格 (Visuals) ---
# 字体
font pango:JetBrainsMono Nerd Font 11

# 间隙 (Gaps) - 适度的间隙有助于区分窗口，减少认知负荷
gaps inner 5
gaps outer 0
default_border pixel 2

# 颜色 (Nord 配色方案 - 冷静、专业)
set $nord0  #2e3440
set $nord1  #3b4252
set $nord2  #434c5e
set $nord3  #4c566a
set $nord4  #d8dee9
set $nord5  #e5e9f0
set $nord6  #eceff4
set $nord7  #8fbcbb
set $nord8  #88c0d0
set $nord9  #81a1c1
set $nord10 #5e81ac
set $nord11 #bf616a
set $nord12 #d08770
set $nord13 #ebcb8b
set $nord14 #a3be8c
set $nord15 #b48ead

# 窗口颜色定义: border background text indicator child_border
client.focused          $nord10 $nord10 $nord6 $nord10 $nord10
client.focused_inactive $nord1  $nord1  $nord4 $nord1  $nord1
client.unfocused        $nord1  $nord0  $nord4 $nord1  $nord1
client.urgent           $nord11 $nord11 $nord6 $nord11 $nord11

# 壁纸 (如果没有图片，先用纯色)
output * bg $nord0 solid_color
output * bg /home/calendar/Pictures/background/壁纸.jpg fill
# --- 输入设备 (Input) ---
# 触控板设置：轻触点击，自然滚动
input type:touchpad {
    dwt enabled
    tap enabled
    natural_scroll enabled
    middle_emulation enabled
}

# 键盘设置
input type:keyboard {
    xkb_layout us
    xkb_numlock enabled
    repeat_delay 250
    repeat_rate 30
    xkb_options caps:escape
}

# --- 关键快捷键 (Keybindings) ---
# 启动终端
bindsym $mod+t exec $term

# 按下 Mod + b 切换 Waybar 显示/隐藏
bindsym $mod+b exec pkill -USR1 waybar

# 休眠、锁屏
bindsym Alt+l exec swaylock -f -i /home/calendar/Pictures/background/壁纸.jpg -s fill
bindsym Alt+Shift+l exec swaylock -f -i /home/calendar/Pictures/background/壁纸.jpg -s fill && sleep 0.2 && systemctl suspend

# 杀掉当前窗口 (Kill Process)
bindsym $mod+q kill

# 打开文件管理器
bindsym $mod+f exec thunar

# 启动器
bindsym $mod+d exec $menu

# 重新加载配置 (不用重启系统)
bindsym $mod+Shift+c reload

# 退出 Sway
bindsym $mod+Shift+e exec swaynag -t warning -m 'Exit Sway?' -B 'Yes, exit sway' 'swaymsg exit'

# --- 窗口布局切换 (Layout Switching) ---
# 切换到堆叠布局 (Stacking)
bindsym $mod+s layout stacking

# 切换到标签布局 (Tabbed)
bindsym $mod+w layout tabbed

# 循环切换布局 (平铺/堆叠/标签)
bindsym $mod+e layout toggle split

# 窗口移动 (Vim 风格: h j k l)
bindsym $mod+h focus left
bindsym $mod+j focus down
bindsym $mod+k focus up
bindsym $mod+l focus right

bindsym $mod+Shift+h move left
bindsym $mod+Shift+j move down
bindsym $mod+Shift+k move up
bindsym $mod+Shift+l move right

# 工作区切换 (1-10)
bindsym $mod+1 workspace number 1
bindsym $mod+2 workspace number 2
bindsym $mod+3 workspace number 3
bindsym $mod+4 workspace number 4
bindsym $mod+5 workspace number 5
bindsym $mod+Shift+1 move container to workspace number 1
bindsym $mod+Shift+2 move container to workspace number 2
bindsym $mod+Shift+3 move container to workspace number 3
bindsym $mod+Shift+4 move container to workspace number 4
bindsym $mod+Shift+5 move container to workspace number 5
# --- Scratchpad (草稿本) ---
# 将当前窗口移入/移出 Scratchpad (隐藏)
bindsym $mod+Shift+minus move scratchpad

# 显示/循环 Scratchpad 中的窗口
bindsym $mod+minus scratchpad show

# 截图 (Grim + Slurp) -> 保存到剪贴板和 Pictures 目录
bindsym $mod+Shift+s exec grim -g "$(slurp)" - | tee ~/Pictures/screenshot-$(date +'%Y-%m-%d-%H%M%S').png | wl-copy
# 强制执行剪贴板监听
exec_always wl-paste --watch cliphist store
# 快捷键：按 Mod+c 呼出剪贴板历史菜单
bindsym $mod+v exec cliphist list | fuzzel -d | cliphist decode | wl-copy
# 多媒体控制 (音量/亮度)
bindsym XF86AudioRaiseVolume exec pamixer -i 5
bindsym XF86AudioLowerVolume exec pamixer -d 5
bindsym XF86AudioMute exec pamixer -t
bindsym XF86MonBrightnessUp exec brightnessctl set +5%
bindsym XF86MonBrightnessDown exec brightnessctl set 5%-

# --- 自动启动 (Autostart) ---
# 启动状态栏
bar {
    swaybar_command waybar
}

# 锁屏
# 使用 swayidle 管理休眠锁屏
exec swayidle -w \
    timeout 300 'swaylock -f -i /home/calendar/Pictures/background/壁纸.jpg -s fill' \
    before-sleep 'swaylock -f -i /home/calendar/Pictures/background/壁纸.jpg -s fill'
# 通知服务
exec mako
exec --no-startup-id fcitx5 -d --replace
exec autotiling
exec_always pkill kanshi; exec kanshi
# 环境变量
exec dbus-update-activation-environment --systemd WAYLAND_DISPLAY XDG_CURRENT_DESKTOP=sway
exec_always nm-applet
# --- 系统服务 ---
# 身份认证代理 (Polkit)
exec_always /usr/lib/mate-polkit/polkit-mate-authentication-agent-1

# --- 调整模式配置 (Resize Mode) ---
# 1. 定义模式名称
mode "resize" {
    # 2. 定义该模式下的动作
    # 缩容 (Shrink)
    bindsym h resize shrink width 10px
    bindsym k resize grow height 10px
    bindsym j resize shrink height 10px
    bindsym l resize grow width 10px

    # 同样的逻辑绑定到方向键 (可选)
    bindsym Left resize shrink width 10px
    bindsym Up resize grow height 10px
    bindsym Down resize shrink height 10px
    bindsym Right resize grow width 10px

    # 3. 退出模式
    bindsym Return mode "default"
    bindsym Escape mode "default"
    bindsym $mod+r mode "default"
}

# 4. 进入调整模式的入口 (Mod + r)
bindsym $mod+r mode "resize"
